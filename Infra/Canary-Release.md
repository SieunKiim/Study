# 카나리 배포란?

새로운 버전을 전체 사용자가 아닌 일부 사용자에게만 먼저 배포해서 안전성을 검증하는 배포 전략.

요청되는 유입의 일부분부터 새로운 버전을 통해 수행하도록하여, 유입량을 점진적으로 늘리면서 안전성과 동작에 대한 검증을 진행할 수 있는 특징이 있다.

## 장점 및 활용도

### 장점

* 문제 발생 시 영향받는 사용자 혹은 시스템의 수가 제한적임.
* 빠른 롤백 가능 (트래픽만 다시 라우팅)
* 점진적인 확대로 안전성을 보장

### 활용도

* A/B테스트와같은 반응 및 통계 집계에 유용
* 성능 및 에러율을 실시간으로 비교 가능함.

## 단점 및 주의점

* 유저 측면에서 일관적인 응답을 받지 못할 수 있음
* 데이터 저장 로직에대한 버전 변경일 경우, 서버별 버전차로 인한 장애 발생 가능
  * 변경된 버전으로 인한 저장 혹은 수정 값이 생긴 경우 롤백 처리 난이도 증가
* MSA 환경에서 통신하는 타 서버간 버전 불일치로 인한 혼선 가능
* 로깅 및 운영 방식의 변경으로 인한 관리 포인트 증가

### -> 해결/완화 방법

* 요청 아이디 및 특정 기준으로 동일한 서버로 요청 가도록 설정
* 버전에 대한 로깅 및 명시를 통한 운영